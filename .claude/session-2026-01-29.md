# Sessao de Desenvolvimento - 29/01/2026

## Resumo
Sessao de manutencao e correcao de bugs no projeto EDEN (plataforma de estudo biblico com IA).

---

## Tarefas Realizadas

### 1. Login com Apple (CANCELADO)
**Solicitacao:** Implementar login com Apple no sistema de autenticacao.

**O que foi feito:**
- Codigo implementado em `AuthContext.tsx` (funcao `signInWithApple` usando `OAuthProvider`)
- Botao adicionado em `AuthScreen.tsx`
- Traducoes adicionadas em `constants.ts` (pt/en/es)

**Por que foi cancelado:**
- Login com Apple requer conta no Apple Developer Program ($99/ano)
- Usuario optou por nao gastar com isso no momento
- Todo o codigo foi **removido** a pedido do usuario

**Arquivos modificados e revertidos:**
- `src/contexts/AuthContext.tsx`
- `src/components/auth/AuthScreen.tsx`
- `src/utils/constants.ts`

---

### 2. Correcao de Referencias Cruzadas (CONCLUIDO)
**Problema:** Ao clicar em uma referencia cruzada (ex: "Joao 1:1" a partir de Genesis), o painel secundario mostrava o livro errado no titulo (mostrava "Genesis" ao inves de "Joao").

**Causa raiz:**
No `BibleContext.tsx`, havia um `useEffect` que sincronizava automaticamente o `secondaryBibleRef` com o `bibleRef` sempre que o modo de comparacao estava ativo. Isso era intencional para o modo de comparacao normal (mesmo livro, traducoes diferentes), mas quebrava as referencias cruzadas (livros diferentes).

**Solucao implementada:**
Adicionado flag `isCrossReference` no BibleContext para diferenciar:
- **Modo comparacao** (`isCrossReference = false`): sincroniza livro/capitulo
- **Referencia cruzada** (`isCrossReference = true`): NAO sincroniza, mantem livro/capitulo da referencia

**Arquivos modificados:**

1. **`src/contexts/BibleContext.tsx`**
   - Adicionado estado `isCrossReference` (linha 94)
   - Adicionado na interface `BibleContextData` (linhas 18-20)
   - Modificado useEffect de sincronizacao para verificar `!isCrossReference` (linha 114)
   - Exportado no Provider value (linhas 181-182)

2. **`src/App.tsx`**
   - Importado `setIsCrossReference` do `useBible()` (linha 118)
   - Modificado `handleParallelClick` para setar `setIsCrossReference(true)` (linha 433)
   - Modificado `onToggleCompare` para resetar `setIsCrossReference(false)` (linha 823)

**Commit:** `a7b2066` - fix: corrige titulo do livro nas referencias cruzadas

---

## Arquitetura de Autenticacao do Projeto

### Provedores implementados:
- **Google OAuth** - Funcional
- **Email/Senha** - Funcional
- **Visitante (Guest)** - Modo desenvolvimento

### Arquivos principais de auth:
- `src/contexts/AuthContext.tsx` - Context de autenticacao
- `src/components/auth/AuthScreen.tsx` - Tela de login/registro
- `src/components/auth/CompleteProfileScreen.tsx` - Completar perfil
- `src/components/auth/ProfileModal.tsx` - Edicao de perfil
- `src/services/firebase.ts` - Configuracao Firebase

### Fluxo de autenticacao:
1. `ProtectedRoute` verifica estado de auth
2. Se nao autenticado -> `AuthScreen`
3. Se autenticado com `age === 0` -> `CompleteProfileScreen`
4. Se autenticado completo -> App principal

---

## Arquitetura do Sistema de Leitura Biblica

### Contextos:
- `BibleContext` - Estado da referencia biblica (livro, capitulo, traducao)
- `LanguageContext` - Idioma da interface (pt/en/es)

### Estados importantes no BibleContext:
```typescript
bibleRef: BibleReference          // Referencia principal
secondaryBibleRef: BibleReference // Referencia do painel secundario
compareMode: boolean              // Modo comparacao ativo
isCrossReference: boolean         // Se e referencia cruzada (nao sincroniza)
secondaryTranslation: string      // Traducao do painel secundario
```

### Componentes de leitura:
- `ReadingView.tsx` - View principal de leitura
- `ResizableSplitView.tsx` - Split view redimensionavel
- `SimpleMarkdown.tsx` - Renderiza markdown com links de referencias

---

## URLs de Deploy

- **Firebase Hosting:** https://gen-lang-client-0295226702.web.app
- **Vercel:** https://eden-de-volta-ao-principio.vercel.app
- **Repositorio:** https://github.com/marcuspalucci/Eden-Customizado

---

## Comandos Uteis

```bash
# Desenvolvimento local
npm run dev

# Build de producao
npm run build

# Deploy Firebase
firebase deploy --only hosting

# Verificar status git
git status

# Ver commits recentes
git log --oneline -10
```

---

## Proximos Passos Sugeridos

1. **Login com Apple** - Implementar quando tiver conta Apple Developer
2. **Melhorias de performance** - Chunk splitting para reduzir bundle size (warning no build)
3. **Testes** - Adicionar testes para o fluxo de referencias cruzadas

---

## Notas Tecnicas

- Projeto usa **React 19** + **TypeScript** + **Vite**
- Firebase SDK versao **compat** (firebase/compat/app)
- Tailwind CSS para estilos
- Google Generative AI (Gemini) para funcionalidades de IA
